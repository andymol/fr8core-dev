{ "files": [ { "id": "13d56b0f-93d2-42f2-8c53-f1c73955638e", "name": "Code", "type": "server_js", 
               "source": "function Initialize() {\n  try {\n    \n    var triggers \u003d ScriptApp.getProjectTriggers();\n \n    for (var i in triggers){\n      if(triggers[i].getTriggerSourceId() \u003d\u003d \"@ID\"){\n        ScriptApp.deleteTrigger(triggers[i]);\n      }\n    }\n    \n    ScriptApp.newTrigger(\"EmailGoogleFormData\")\n    .forForm(FormApp.openById(\u0027@ID\u0027))\n    .onFormSubmit().create();\n    \n  } catch (error) {\n    throw new Error(\"Please add this code\");\n  }\n}\n\nfunction EmailGoogleFormData(e) {\n  \n  if (!e) {\n    throw new Error(\"Please go the Run menu and choose Initialize\");\n  }\n  \n  try {\n      \n    var response \u003d \"\";\n      \n      // Open a form by ID and log the responses to each question.\n      var form \u003d FormApp.openById(\u0027@ID\u0027);\n      var timestampInit \u003d new Date();\n      timestampInit.setSeconds(timestampInit.getSeconds() - 30);\n      var formResponses \u003d form.getResponses(timestampInit);\n    \n      for (var i \u003d 0; i \u003c formResponses.length; i++) {\n        var formResponse \u003d formResponses[i];\n        var itemResponses \u003d formResponse.getItemResponses();\n        for (var j \u003d 0; j \u003c itemResponses.length; j++) {\n          var itemResponse \u003d itemResponses[j];\n          response +\u003d Utilities.formatString(\u0027%s\u003d%s\u0026\u0027,\n                                            itemResponse.getItem().getTitle(),\n                                            itemResponse.getResponse());\n        }\n      }\n    var emailId \u003d Session.getActiveUser().getEmail();\n    \n    var resp \u003d UrlFetchApp\n      .fetch(\n          \u0027@ENDPOINT\u0027,\n          {\n            method: \u0027post\u0027,\n            payload: {\n              \u0027response\u0027 : response,\n              \u0027user_id\u0027 : emailId\n            }\n          });\n  Logger.log(resp.getContentText());\n      \n  } catch (error) {\n    Logger.log(error.toString());\n  }\n}" } ] }